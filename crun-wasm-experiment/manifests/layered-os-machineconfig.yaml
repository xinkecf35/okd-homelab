apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master # not typical , but compact setup 
  name: 99-crun-wasm-os-layer
spec:
  osImageURL: zot-registry.home.arpa/okd-wasm-lab/centos-stream-10-coreos-crun-wasm@sha256:18e9980ec0815af232953b2d7b8eefe2689fbc468db58233dcaef70431457c0a
  # Modified from now deprecated RH blog post https://www.redhat.com/en/blog/webassembly-wasm-and-openshift-a-powerful-duo-for-modern-applications
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
      - contents:
          source: data:text/plain;charset=utf-8;base64,W2NyaW8ucnVudGltZS5ydW50aW1lcy5jcnVuLXdhc21dCnJ1bnRpbWVfcGF0aCA9ICIvdXNyL2Jpbi9jcnVuLXdhc20iCnBsYXRmb3JtX3J1bnRpbWVfcGF0aHMgPSB7Indhc2kvd2FzbTMyIiA9ICIvdXNyL2Jpbi9jcnVuLXdhc20ifQ==
        mode: 420
        overwrite: true
        path: /etc/crio/crio.conf.d/99-crun-wasm.conf